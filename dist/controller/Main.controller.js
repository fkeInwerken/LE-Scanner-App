sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","sap/m/MessageToast"],function(t,e,o){"use strict";return t.extend("inw.le_scanner.controller.Main",{onInit:function(){const t=new e({istLagereinheitBarcode:"",sollLagerplatzBarcode:"",istLagerplatzBarcode:"",sollLagereinheitBarcode:"",TANummer:"",anzahlPositionen:"",istLagerplatzBarcodeState:"None",istLagerplatzBarcodeStateText:"",sollLagereinheitBarcodeState:"None",sollLagereinheitBarcodeStateText:"",appVersion:this.getOwnerComponent().getManifestEntry("sap.app").applicationVersion.version});this.setModel(t,"viewModel");const o=this.byId("istLagereinheitBarcode");const n=this.byId("istLagerplatzBarcode");const s=this.byId("sollLagereinheitBarcode");const i=[o,n,s];this.aInputs=[o,n,s];i.forEach(t=>{t.addEventDelegate({onAfterRendering:()=>{const e=t.getDomRef("inner");if(!e)return;e.setAttribute("inputmode","none");e.addEventListener("focus",e=>{this.onInputFocus(e);this._lastFocusedInputId=t.getId()})}})});document.addEventListener("keydown",this.onKeyDown.bind(this));this.successSound=new Audio("./sounds/success.mp3");this.warningSound=new Audio("./sounds/warning.mp3")},onKeyDown:function(t){const e=t.key;const o=this._getFocusedInputIndex();switch(e){case"DPAD_UP":this.onArrowUp(o);break;case"ArrowUp":this.onArrowUp(o);break;case"DPAD_DOWN":if(o===-1){this.aInputs[0].focus();return}this.onArrowDown(o);break;case"ArrowDown":if(o===-1){this.aInputs[0].focus();return}this.onArrowDown(o);break;case"Escape":this.onP2();break;default:}},onArrowUp:function(t){if(t>0){const e=this.aInputs[t-1];e.focus();this._selectInputText(e)}},onArrowDown:function(t){if(t<this.aInputs.length-1){const e=this.aInputs[t+1];e.focus();this._selectInputText(e)}},onP2:function(){const t=this.byId("buchenButton");t.firePress();this.aInputs[0].focus()},onIstLagereinheitSubmit:function(t){const e=t.getSource();const o=this.aInputs.indexOf(e);const n=e.getDomRef("inner");const s=n.getAttribute("inputmode");this.aInputs[o+1].focus();this.requestBackendData();if(s==="text"){this.onCallKeyboardAction()}},onIstLagerplatzSubmit:function(t){const e=t.getSource();const o=this.aInputs.indexOf(e);const n=e.getDomRef("inner");const s=n.getAttribute("inputmode");this.aInputs[o+1].focus();if(s==="text"){this.onCallKeyboardAction()}},onSollLagereinheitSubmit:function(t){const e=t.getSource();const o=e.getDomRef("inner");const n=o.getAttribute("inputmode");if(n==="text"){this.onCallKeyboardAction()}},onCallKeyboardAction:function(){const t=this.aInputs.findIndex(t=>t.getId()===this._lastFocusedInputId);const e=this.aInputs[t-1].getId();this.onKeyboardAction(e)},requestBackendData:function(){const t={TANummer:"390",anzahlPositionen:3,sollLagerplatzBarcode:"101-02-B-1"};const e=this.getModel("viewModel");e.setProperty("/TANummer",t.TANummer);e.setProperty("/anzahlPositionen",t.anzahlPositionen);e.setProperty("/sollLagerplatzBarcode",t.sollLagerplatzBarcode)},onBuchenPress:function(){o.show("Erfolgreich gebucht!");const t=this.getModel("viewModel");t.setProperty("/istLagereinheitBarcode","");t.setProperty("/sollLagerplatzBarcode","");t.setProperty("/istLagerplatzBarcode","");t.setProperty("/sollLagereinheitBarcode","");t.setProperty("/TANummer","");t.setProperty("/anzahlPositionen","");t.setProperty("/istLagerplatzBarcodeState","None");t.setProperty("/istLagerplatzBarcodeStateText","");t.setProperty("/sollLagereinheitBarcodeState","None");t.setProperty("/sollLagereinheitBarcodeStateText","")},onInputFocus:function(t){const e=t.srcElement;e.setSelectionRange(0,e.value.length)},onIstLagerplatzChange:function(){const t=this.getView().getModel("viewModel");const e=t.getProperty("/istLagerplatzBarcode");const o=t.getProperty("/sollLagerplatzBarcode");if(e===o){t.setProperty("/istLagerplatzBarcodeState","Success");t.setProperty("/istLagerplatzBarcodeStateText","Soll = Ist Nachlagerplatz");t.setProperty("/sollLagereinheitBarcodeStateText","Soll = Ist Lagereinheit");this.successSound.play()}else{t.setProperty("/istLagerplatzBarcodeState","Warning");t.setProperty("/istLagerplatzBarcodeStateText","Soll ≠ Ist Nachlagerplatz");this.warningSound.play()}},onSollLagereinheitChange:function(){const t=this.getModel("viewModel");const e=t.getProperty("/istLagereinheitBarcode");const o=t.getProperty("/sollLagereinheitBarcode");if(e===o){t.setProperty("/sollLagereinheitBarcodeState","Success");t.setProperty("/sollLagereinheitBarcodeStateText","Soll = Ist Lagereinheit");this.successSound.play()}else{t.setProperty("/sollLagereinheitBarcodeState","Warning");t.setProperty("/sollLagereinheitBarcodeStateText","Soll ≠ Ist Lagereinheit");this.warningSound.play()}},onKeyboardAction:function(t){let e=null;if(typeof t==="string"){const o=this.byId(t);if(o&&o.isA("sap.m.Input")){e=t}}if(!e){e=this._lastFocusedInputId}const o=this.byId(e);const n=o.getDomRef("inner");if(n){const t=n.getAttribute("inputmode");const e=t==="text"?"none":"text";n.setAttribute("inputmode",e);setTimeout(()=>{o.focus();n.select?.()},100)}},_getFocusedInputIndex:function(){const t=document.activeElement.id;return this.aInputs.findIndex(e=>e.getId()===t.replace(/-inner$/,""))},_selectInputText:function(t){setTimeout(()=>{const e=t.getDomRef("inner");if(e){e.setSelectionRange(0,e.value.length)}},0)},onResetApp:function(){location.reload()}})});
//# sourceMappingURL=Main.controller.js.map